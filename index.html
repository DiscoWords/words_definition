<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Word Definitions</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
    body {
        font-family: "Times New Roman", serif;
        margin: 0;
        padding: 0;
        background-color: #121212;
        color: #f5f5f5;
        opacity: 0;
        animation: fadeIn 1s ease-in forwards;
        position: relative;
        overflow: hidden; /* Prevent body scroll */
    }

    @keyframes fadeIn { from {opacity: 0;} to {opacity: 1;} }

    /* Animated Background */
    .background-blurs {
        position: fixed;
        top: 0; left: 0;
        width: 100%;
        height: 100%;
        z-index: -2;
        overflow: hidden;
    }
    .blur-circle {
        position: absolute;
        border-radius: 50%;
        filter: blur(140px);
        opacity: 0.25; /* کاهش شفافیت برای تیره‌تر شدن */
    }
    body::after {
        content: "";
        position: fixed;
        top: 0; left: 0;
        width: 100%; height: 100%;
        background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAAARlJREFUaIHt1M0NwjAUBlAb6Cg6gI7gGjlCB3AFHdABdBRHcAR0AFUoRAxJ/158fUmKZH6S/N329gQAgG83AAB/xYBSAAAAYQlIAABYSJAAAACwECQBAAAWEiQAAACsBEgAAFgIkQAAALASIIE/YUECBDaCAgQ2igIEPsICBD6CAgQ+igIE/oYFCGwEBQhsFAUI/AwLEPgMCxD4DAoQ+BkWIHATFCDwExQg8BMUIPATFCDwExQg8BMUIPATFCDwExQg8BMUIPATFCDwExQg8BMUIPATFCDwExQg8BMUIPATFCDwExQg8BMUIPATFCDwExQg8BMUIPATFCDwExQg8BMUIPATFCDwExQgsBEUILA5FAAAgF8CegB75sHyJpAAAAAElFTkSuQmCC');
        opacity: 0.05;
        z-index: -1;
    }

    @keyframes move-circle1 {
        0% {transform: translate(-20%, -20%) scale(1);}
        100% {transform: translate(80%, 60%) scale(1.2);}
    }
    @keyframes move-circle2 {
        0% {transform: translate(70%, 20%) scale(1);}
        100% {transform: translate(-30%, -40%) scale(0.8);}
    }
    @keyframes move-circle3 {
        0% {transform: translate(20%, 70%) scale(0.9);}
        100% {transform: translate(60%, -50%) scale(1.1);}
    }

    /* Pages */
    .page-container {
        display: none; /* Hide all pages by default */
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 100vh;
        padding: 40px;
        box-sizing: border-box;
    }
    .page-container.active {
        display: flex; /* Show only the active page */
    }
    /* ** FIX FOR SCROLLING ** */
    .page-container.scrollable {
        justify-content: flex-start; /* Align to top to allow scrolling */
        overflow-y: auto;
    }

    /* Buttons */
    .start-option {
        font-family: "Times New Roman", serif;
        font-size: 26px;
        font-weight: bold;
        margin: 12px 0;
        padding: 18px 36px;
        cursor: pointer;
        background-color: rgba(255, 255, 255, 0.1);
        color: white;
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 12px;
        transition: background-color 0.3s, transform 0.2s;
        width: 300px;
        text-align: center;
    }
    .start-option:hover {
        background-color: rgba(255, 255, 255, 0.2);
        transform: scale(1.03);
    }

    .unit-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: 15px;
        width: 100%;
        max-width: 800px;
        margin-top: 20px;
    }
    .unit-option {
        font-size: 16px;
        padding: 15px;
        cursor: pointer;
        background-color: rgba(255, 255, 255, 0.1);
        color: white;
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 8px;
        transition: background-color 0.3s, transform 0.2s;
    }
    .unit-option:hover {
        background-color: rgba(255, 255, 255, 0.2);
        transform: scale(1.05);
    }

    .word-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-top: 20px;
        width: 100%;
        max-height: 80vh; /* Limits height to allow scrolling within container */
        overflow-y: auto;
        padding: 0 20px;
    }
    .word {
        font-size: 20px;
        font-weight: bold;
        cursor: pointer;
        margin: 8px 0;
        transition: color 0.3s ease-in-out;
        opacity: 0;
        transform: translateY(10px);
        animation: fadeWord 0.6s ease-in-out forwards;
    }
    @keyframes fadeWord {
        from {opacity: 0; transform: translateY(10px);}
        to {opacity: 1; transform: translateY(0);}
    }
    .definition {
        font-size: 18px;
        font-style: italic;
        color: #ccc;
        display: none;
        margin-top: 4px;
        max-width: 80%;
        line-height: 1.5;
        animation: fadeInDefinition 0.3s ease-in-out;
        text-align: center;
    }
    @keyframes fadeInDefinition {
        from {opacity: 0; transform: translateY(-5px);}
        to {opacity: 1; transform: translateY(0);}
    }

    h1 {font-size: 40px; margin-bottom: 30px; text-align: center;}

    .back-btn {
        position: absolute;
        top: 20px;
        left: 20px;
        font-size: 16px;
        padding: 8px 16px;
        background-color: rgba(255, 255, 255, 0.1);
        color: white;
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 8px;
        cursor: pointer;
        transition: background-color 0.3s;
        z-index: 10;
    }
    .back-btn:hover {
        background-color: rgba(255, 255, 255, 0.2);
    }
</style>
</head>
<body>

<div class="background-blurs">
    <div class="blur-circle circle1"></div>
    <div class="blur-circle circle2"></div>
    <div class="blur-circle circle3"></div>
</div>

<div id="preStartPage" class="page-container active">
    <button class="start-option" data-target="startPage">Disco</button>
    <button class="start-option" data-target="cambridgePage">Cambridge</button>
</div>

<div id="startPage" class="page-container">
    <button class="back-btn" data-target="preStartPage">Back</button>
    <button class="start-option" id="wordDefinitionsBtn">Word Definitions</button>
    <button class="start-option" id="discoStoriesBtn">Disco Stories</button>
</div>

<div id="cambridgePage" class="page-container scrollable">
    <button class="back-btn" data-target="preStartPage">Back</button>
    <h1>Cambridge Units</h1>
    <div class="unit-grid" id="unitGridContainer"></div>
</div>

<div id="contentPage" class="page-container">
    <button class="back-btn" id="contentBackBtn">Back</button>
    <h1 id="pageTitle"></h1>
    <div class="word-container" id="wordContainer"></div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const pages = {
        preStartPage: document.getElementById('preStartPage'),
        startPage: document.getElementById('startPage'),
        cambridgePage: document.getElementById('cambridgePage'),
        contentPage: document.getElementById('contentPage')
    };

    const wordContainer = document.getElementById('wordContainer');
    const pageTitle = document.getElementById('pageTitle');
    const contentBackBtn = document.getElementById('contentBackBtn');

    const fileUrls = {
        wordDefinitions: "https://raw.githubusercontent.com/DiscoWords/words_definition/refs/heads/main/longman_definitions.xlsx",
        discoStories: "https://raw.githubusercontent.com/DiscoWords/words_definition/refs/heads/main/Notes_Disco.xlsx",
        cambridgeBaseUrl: "https://raw.githubusercontent.com/DiscoWords/words_definition/refs/heads/main/"
    };

    // ** ROBUST NAVIGATION LOGIC **
    function showPage(pageId) {
        Object.values(pages).forEach(p => p.classList.remove('active'));
        if (pages[pageId]) {
            pages[pageId].classList.add('active');
        }
    }
    
    // Generic button click handler for navigation
    document.body.addEventListener('click', (e) => {
        const targetPage = e.target.dataset.target;
        if (targetPage && pages[targetPage]) {
            showPage(targetPage);
        }
    });
    
    // Cambridge Units Generation
    function generateCambridgeUnits() {
        const unitGridContainer = document.getElementById('unitGridContainer');
        for (let i = 1; i <= 22; i++) {
            const unitBtn = document.createElement('button');
            unitBtn.className = 'unit-option';
            unitBtn.textContent = `Unit ${i}`;
            unitBtn.addEventListener('click', () => {
                const fileUrl = `${fileUrls.cambridgeBaseUrl}Unit_${i}.xlsx`;
                loadContentPage(`Unit ${i}`, fileUrl, 'cambridgePage');
            });
            unitGridContainer.appendChild(unitBtn);
        }
    }

    // Specific button event listeners
    document.getElementById('wordDefinitionsBtn').addEventListener('click', () => {
        loadContentPage("Word Definitions", fileUrls.wordDefinitions, 'startPage');
    });

    document.getElementById('discoStoriesBtn').addEventListener('click', () => {
        loadContentPage("Disco Stories", fileUrls.discoStories, 'startPage');
    });


    function loadContentPage(name, url, fromPage) {
        showPage('contentPage');
        contentBackBtn.dataset.target = fromPage; // ** FIX FOR BACK BUTTON **
        pageTitle.textContent = name;
        loadExcelData(url);
    }

    function loadExcelData(fileUrl) {
        wordContainer.innerHTML = "<h1>Loading...</h1>";
        fetch(fileUrl)
            .then(res => {
                if (!res.ok) throw new Error(`Network response was not ok: ${res.statusText}`);
                return res.arrayBuffer();
            })
            .then(data => {
                const workbook = XLSX.read(data, { type: "array" });
                const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                const rows = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });
                wordContainer.innerHTML = "";
                rows.forEach((row, index) => {
                    if (row && row.length >= 2) {
                        const word = String(row[0] || "").trim();
                        const def = String(row[1] || "").trim();
                        if (word && def) {
                            const wEl = document.createElement("div");
                            wEl.className = "word";
                            wEl.textContent = word;
                            wEl.style.animationDelay = `${index * 0.05}s`;
                            
                            const dEl = document.createElement("div");
                            dEl.className = "definition";
                            dEl.innerHTML = def.replace(/\n/g, "<br>");

                            wEl.addEventListener("click", () => {
                                dEl.style.display = (dEl.style.display === "none" || !dEl.style.display) ? "block" : "none";
                            });
                            
                            wordContainer.appendChild(wEl);
                            wordContainer.appendChild(dEl);
                        }
                    }
                });
            })
            .catch(err => {
                console.error('Fetch Error:', err);
                wordContainer.innerHTML = `<h1>Error Loading Data</h1><p>${err.message}</p>`;
            });
    }

    // Random colors for background circles
    function setRandomCircleColors() {
        const palettes = [
            ["#ff4d4d", "#ff944d", "#ffd24d"], ["#4dafff", "#4d94ff", "#4dd2ff"],
            ["#bb4dff", "#944dff", "#d24dff"], ["#4dff88", "#4dffc2", "#4dfff5"]
        ];
        const palette = palettes[Math.floor(Math.random() * palettes.length)];
        const circles = document.querySelectorAll('.blur-circle');
        circles[0].style.background = palette[0];
        circles[1].style.background = palette[1];
        circles[2].style.background = palette[2];
        circles[0].style.width = "600px"; circles[0].style.height = "600px";
        circles[1].style.width = "500px"; circles[1].style.height = "500px";
        circles[2].style.width = "400px"; circles[2].style.height = "400px";
        circles[0].style.animation = "move-circle1 25s infinite alternate ease-in-out";
        circles[1].style.animation = "move-circle2 30s infinite alternate ease-in-out";
        circles[2].style.animation = "move-circle3 20s infinite alternate ease-in-out";
    }

    // Initialize the app
    generateCambridgeUnits();
    setRandomCircleColors();
    showPage('preStartPage'); // Start on the preStart page
});
</script>
</body>
</html>

const discoBtn = document.getElementById('discoBtn');
const cambridgeBtn = document.getElementById('cambridgeBtn');
const wordDefinitionsBtn = document.getElementById('wordDefinitionsBtn');
const discoStoriesBtn = document.getElementById('discoStoriesBtn');

const unitGridContainer = document.getElementById('unitGridContainer');
const wordContainer = document.getElementById('wordContainer');
const pageTitle = document.getElementById('pageTitle');
const contentBackBtn = document.getElementById('contentBackBtn');

let lastPageBeforeContent = 'preStart';

const fileUrls = {
    wordDefinitions: "https://raw.githubusercontent.com/DiscoWords/words_definition/refs/heads/main/longman_definitions.xlsx",
    discoStories: "https://raw.githubusercontent.com/DiscoWords/words_definition/refs/heads/main/Notes_Disco.xlsx",
    cambridgeBaseUrl: "https://raw.githubusercontent.com/DiscoWords/words_definition/refs/heads/main/"
};

// Navigation
function showPage(pageId){
    Object.values(pages).forEach(p=>p.style.display='none');
    pages[pageId].style.display='flex';
    if (pageId === 'cambridge') pages[pageId].classList.add('scrollable');
}

discoBtn.addEventListener('click',()=>{
    lastPageBeforeContent = 'start';
    showPage('start');
});
cambridgeBtn.addEventListener('click',()=>{
    lastPageBeforeContent = 'cambridge';
    showPage('cambridge');
});

document.querySelectorAll('.back-btn').forEach(btn=>{
    btn.addEventListener('click',(e)=>{
        const target = e.target.dataset.target;
        if (target) showPage(target);
    });
});

contentBackBtn.addEventListener('click',()=>{
    showPage(lastPageBeforeContent);
});

// Cambridge Units
function generateCambridgeUnits(){
    for(let i=1;i<=22;i++){
        const unitBtn = document.createElement('button');
        unitBtn.className='unit-option';
        unitBtn.textContent=`Unit ${i}`;
        unitBtn.addEventListener('click',()=>{
            lastPageBeforeContent = 'cambridge';
            const fileUrl=`${fileUrls.cambridgeBaseUrl}Unit_${i}.xlsx`;
            loadPage(`Unit ${i}`,fileUrl);
        });
        unitGridContainer.appendChild(unitBtn);
    }
}

// Load Page
wordDefinitionsBtn.addEventListener('click',()=>{
    lastPageBeforeContent = 'start';
    loadPage("Word Definitions",fileUrls.wordDefinitions);
});
discoStoriesBtn.addEventListener('click',()=>{
    lastPageBeforeContent = 'start';
    loadPage("Disco Stories",fileUrls.discoStories);
});

function loadPage(name,url){
    showPage('content');
    pageTitle.textContent=name;
    loadExcelData(url);
}

function loadExcelData(fileUrl){
    wordContainer.innerHTML="<h1>Loading...</h1>";
    fetch(fileUrl)
    .then(res=>{
        if(!res.ok) throw new Error(`Error ${res.status}`);
        return res.arrayBuffer();
    })
    .then(data=>{
        const workbook = XLSX.read(data,{type:"array"});
        const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
        const rows = XLSX.utils.sheet_to_json(firstSheet,{header:1});
        wordContainer.innerHTML="";
        rows.forEach((row,index)=>{
            if(row && row.length>=2){
                const word = String(row[0]||"").trim();
                const def = String(row[1]||"").trim();
                if(word && def){
                    const wEl=document.createElement("div");
                    wEl.className="word";
                    wEl.textContent=word;
                    wEl.style.animationDelay = `${index*0.05}s`;
                    const dEl=document.createElement("div");
                    dEl.className="definition";
                    dEl.innerHTML=def.replace(/\n/g,"<br>");
                    wEl.addEventListener("click",()=>{
                        dEl.style.display = (dEl.style.display==="none"||!dEl.style.display) ? "block" : "none";
                    });
                    wordContainer.appendChild(wEl);
                    wordContainer.appendChild(dEl);
                }
            }
        });
    })
    .catch(err=>{
        wordContainer.innerHTML=`<h1>Error</h1><p>${err.message}</p>`;
    });
}

// Random colors for background circles
function setRandomCircleColors(){
    const palettes = [
        ["#ff4d4d","#ff944d","#ffd24d"],
        ["#4dafff","#4d94ff","#4dd2ff"],
        ["#bb4dff","#944dff","#d24dff"],
        ["#4dff88","#4dffc2","#4dfff5"]
    ];
    const palette = palettes[Math.floor(Math.random()*palettes.length)];
    const circles = document.querySelectorAll('.blur-circle');
    circles[0].style.background=palette[0];
    circles[1].style.background=palette[1];
    circles[2].style.background=palette[2];
    circles[0].style.width="600px"; circles[0].style.height="600px";
    circles[1].style.width="500px"; circles[1].style.height="500px";
    circles[2].style.width="400px"; circles[2].style.height="400px";
    circles[0].style.animation="move-circle1 25s infinite alternate";
    circles[1].style.animation="move-circle2 30s infinite alternate";
    circles[2].style.animation="move-circle3 20s infinite alternate";
}

// Init
generateCambridgeUnits();
showPage('preStart');
setRandomCircleColors();
</script>
</body>
</html>
            cursor: pointer;
            background-color: rgba(255, 255, 255, 0.1); /* روشن‌تر و شفاف */
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px; /* انحنای گوشه‌ها */
            transition: background-color 0.3s, transform 0.2s;
            width: 300px;
        }

        .start-option:hover {
            background-color: rgba(255, 255, 255, 0.2);
            transform: scale(1.03);
        }

        .unit-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            width: 80%;
            max-width: 800px;
            margin-top: 20px;
        }

        .unit-option {
            font-family: sans-serif; /* فونت ساده‌تر برای یونیت‌ها */
            font-size: 16px;
            padding: 15px;
            cursor: pointer;
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            transition: background-color 0.3s, transform 0.2s;
        }

        .unit-option:hover {
            background-color: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }

        .word-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 20px;
            max-height: 80vh;
            overflow-y: auto;
            padding: 0 20px;
        }

        .word {
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            margin: 8px 0;
            transition: color 0.3s ease-in-out;
            opacity: 0;
            transform: translateY(10px);
            animation: fadeWord 0.6s ease-in-out forwards;
        }

        @keyframes fadeWord {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .definition {
            font-size: 18px;
            font-style: italic;
            color: #ccc;
            display: none;
            margin-top: 4px;
            max-width: 80%;
            line-height: 1.5;
            animation: fadeInDefinition 0.3s ease-in-out;
        }

        @keyframes fadeInDefinition {
            from { opacity: 0; transform: translateY(-5px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade {
            animation: fadeIn 1s ease-in-out forwards;
        }

        h1 {
            font-size: 40px;
            margin-bottom: 30px;
        }

        .back-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 16px;
            padding: 8px 16px;
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .back-btn:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

    </style>
</head>
<body>
    
    <div class="background-blurs">
        <div class="blur-circle circle1"></div>
        <div class="blur-circle circle2"></div>
        <div class="blur-circle circle3"></div>
    </div>

    <!-- NEW: Pre-Start Page -->
    <div id="preStartPage" class="page-container">
        <button class="start-option" id="discoBtn">Disco</button>
        <button class="start-option" id="cambridgeBtn">Cambridge</button>
    </div>

    <div id="startPage" class="page-container" style="display: none;">
        <button class="back-btn" data-target="preStartPage">Back</button>
        <button class="start-option" id="wordDefinitionsBtn">Word Definitions</button>
        <button class="start-option" id="discoStoriesBtn">Disco Stories</button>
    </div>
    
    <!-- NEW: Cambridge Units Page -->
    <div id="cambridgePage" class="page-container" style="display: none;">
        <button class="back-btn" data-target="preStartPage">Back</button>
        <h1>Cambridge Units</h1>
        <div class="unit-grid" id="unitGridContainer">
            <!-- Units will be generated by JS -->
        </div>
    </div>

    <div id="contentPage" class="fade" style="display: none;">
        <button class="back-btn" id="contentBackBtn">Back</button>
        <h1 id="pageTitle"></h1>
        <div class="word-container" id="wordContainer"></div>
    </div>

    <script>
        // Page elements
        const pages = {
            preStart: document.getElementById('preStartPage'),
            start: document.getElementById('startPage'),
            cambridge: document.getElementById('cambridgePage'),
            content: document.getElementById('contentPage')
        };

        // Main buttons
        const discoBtn = document.getElementById('discoBtn');
        const cambridgeBtn = document.getElementById('cambridgeBtn');
        const wordDefinitionsBtn = document.getElementById('wordDefinitionsBtn');
        const discoStoriesBtn = document.getElementById('discoStoriesBtn');
        
        // Content elements
        const unitGridContainer = document.getElementById('unitGridContainer');
        const wordContainer = document.getElementById('wordContainer');
        const pageTitle = document.getElementById('pageTitle');
        const contentBackBtn = document.getElementById('contentBackBtn');

        let lastPageBeforeContent = 'preStart'; // To track where to go back to

        const fileUrls = {
            wordDefinitions: "https://raw.githubusercontent.com/DiscoWords/words_definition/refs/heads/main/longman_definitions.xlsx",
            discoStories: "https://raw.githubusercontent.com/DiscoWords/words_definition/refs/heads/main/Notes_Disco.xlsx",
            cambridgeBaseUrl: "https://raw.githubusercontent.com/DiscoWords/words_definition/refs/heads/main/"
        };
        
        // --- Navigation Logic ---
        function showPage(pageId) {
            Object.values(pages).forEach(page => page.style.display = 'none');
            pages[pageId].style.display = 'flex';
            if (pageId === 'content') pages[pageId].style.display = 'block';
        }

        discoBtn.addEventListener('click', () => {
            lastPageBeforeContent = 'start';
            showPage('start');
        });
        
        cambridgeBtn.addEventListener('click', () => {
            lastPageBeforeContent = 'cambridge';
            showPage('cambridge');
        });

        document.querySelectorAll('.back-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const targetPageId = e.target.dataset.target;
                if (targetPageId) {
                    showPage(targetPageId);
                }
            });
        });

        contentBackBtn.addEventListener('click', () => {
            showPage(lastPageBeforeContent);
        });

        // --- Data Loading Logic ---
        wordDefinitionsBtn.addEventListener("click", function() {
            loadPage("Word Definitions", fileUrls.wordDefinitions);
        });

        discoStoriesBtn.addEventListener("click", function() {
            loadPage("Disco Stories", fileUrls.discoStories);
        });
        
        function generateCambridgeUnits() {
            for (let i = 1; i <= 22; i++) {
                const unitBtn = document.createElement('button');
                unitBtn.className = 'unit-option';
                unitBtn.textContent = `Unit ${i}`;
                unitBtn.addEventListener('click', () => {
                    const fileUrl = `${fileUrls.cambridgeBaseUrl}Unit_${i}.xlsx`;
                    loadPage(`Unit ${i}`, fileUrl);
                });
                unitGridContainer.appendChild(unitBtn);
            }
        }

        function loadPage(pageName, fileUrl) {
            showPage('content');
            pageTitle.textContent = pageName;
            loadExcelData(fileUrl);
        }

        function loadExcelData(fileUrl) {
            wordContainer.innerHTML = "<h1>Loading...</h1>"; // Loading indicator
            fetch(fileUrl)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`File not found or network error (${response.status})`);
                    }
                    return response.arrayBuffer();
                })
                .then(data => {
                    const workbook = XLSX.read(data, { type: "array" });
                    const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                    const rows = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });

                    wordContainer.innerHTML = ""; // Clear previous data

                    rows.forEach((row, index) => {
                        if (row && row.length >= 2) {
                            const word = row[0] ? String(row[0]).trim() : '';
                            const definition = row[1] ? String(row[1]).trim() : '';

                            if (word && definition) {
                                const wordElement = document.createElement("div");
                                wordElement.classList.add("word");
                                wordElement.textContent = word;
                                wordElement.style.animationDelay = `${index * 0.05}s`; // Staggered animation

                                const definitionElement = document.createElement("div");
                                definitionElement.classList.add("definition");
                                definitionElement.innerHTML = definition.replace(/\n/g, '<br>'); // Support newlines

                                wordElement.addEventListener("click", function() {
                                    const isHidden = definitionElement.style.display === "none" || definitionElement.style.display === "";
                                    definitionElement.style.display = isHidden ? "block" : "none";
                                });

                                wordContainer.appendChild(wordElement);
                                wordContainer.appendChild(definitionElement);
                            }
                        }
                    });
                })
                .catch(error => {
                    console.error("Error loading Excel file:", error);
                    wordContainer.innerHTML = `<h1>Error</h1><p>Could not load the data from the specified file. Please check the file URL and your network connection.</p><p><em>${error.message}</em></p>`;
                });
        }
        
        // Initialize the app
        generateCambridgeUnits();
        showPage('preStart');

    </script>

</body>
</html>


